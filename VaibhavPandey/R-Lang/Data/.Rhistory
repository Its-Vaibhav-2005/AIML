print(i)
}
d=data.frame(table(k))
View(d)
d=d %>%
arrane(-Freq)
d=d %>%
arrange(-Freq)
d[,c("k")][1:17]
md=md %>%
mutate(
word_google=as.numeric(length(grep("google",url))>0)
)
summary(md$word_google)
words=c("google","twitter","facebook","apple","video","new","app","iphone","social","world","for","2014")
for(word in words){
md[,paste0("word_",word)]=NA
for(i in 1:nrow(md)){
md[,paste0("word_",word)][i]=as.numeric(length(grep(word,md$url[i]))>0)
}
print(word)
}
View(md)
summary(md$word_google)
for(word in words){
md[,paste0("word_",word)]=NA
for(i in 1:nrow(md)){
md[,paste0("word_",word)][i]=as.numeric(length(grep(word,md$url[i]))>0)
}
print(word)
}
names(md)
fit=lm(shares~.-url,md)
summary(fit)
md$apple_url=NULL
rm(fit,fit1,fit2)
print(object.size(k),unit="auto")
rm(i,k,word,words)
fit=lm(shares~.-url,md)
summary(fit)
fit=step(fit)
summary(fit)
apply(md,2,function(x) length(unique(x)))
k=apply(md,2,function(x) length(unique(x)))
sort(k)
md$s_new=NULL
k=apply(md,2,function(x) length(unique(x)))
sort(k)
num_keywords
plot(md$shares,md$LDA_00)
source('~/Desktop/test.R', echo=TRUE)
md=md %>%
group_by(n_non_stop_words) %>%
mutate(nnsw_share=mean(shares)) %>%
group_by(num_keywords) %>%
mutate(numk_share=mean(shares)) %>%
group_by(n_tokens_title) %>%
mutate(ntt_share=mean(shares)) %>%
group_by(kw_min_min) %>%
mutate(kw_min_share=mean(shares)) %>%
group_by(min_positive_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(max_negative_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(num_videos) %>%
mutate(nv_shares=mean(shares)) %>%
group_by(min_negative_polarity) %>%
mutate(minnp_shares=mean(shares)) %>%
group_by(num_self_hrefs) %>%
mutate(nsh_shares=mean(shares)) %>%
group_by(num_imgs) %>%
mutate(num_im_shares=mean(shares)) %>%
group_by(num_hrefs) %>%
mutate(num_hrefs_shares=mean(shares))
fit=lm(shares~.-url,md)
summary(fit)
fit=step(fit)
summary(fit)
plot(fit,which=1)
plot(fit,which=4)
rownames(md)
md=md[-c(3269,23238,31038),]
fit=lm(shares~.-url,md)
plot(fit,which=4)
md=md[-c(5370,9365,16268),]
fit=lm(shares~.-url,md)
plot(fit,which=4)
md=md[-c(3146,9851,35251),]
fit=lm(shares~.-url,md)
plot(fit,which=4)
plot(fit,which=6)
plot(fit,which=4)
md=md[-c(5552,18032,23579),]
fit=lm(shares~.-url,md)
plot(fit,which=4)
summary(fit)
plot(md$shares,md$LDA_01)
plot(md$shares,md$LDA_02)
plot(md$shares,md$LDA_03)
plot(md$shares,md$LDA_04)
md=md %>%
mutate(sp_feat1=shares*0.3+rnorm(1000,1000),
sp_feat2=sqrt(shares)+rnorm(1000,1000))
rm(list=ls())
setwd("/Users/lalitsachan/Desktop/March onwards/CBAP with R/Data/")
library(dplyr)
library(data.table)
md=data.frame(fread("OnlineNewsPopularity.csv"))
md=md %>%
group_by(n_non_stop_words) %>%
mutate(nnsw_share=mean(shares)) %>%
group_by(num_keywords) %>%
mutate(numk_share=mean(shares)) %>%
group_by(n_tokens_title) %>%
mutate(ntt_share=mean(shares)) %>%
group_by(kw_min_min) %>%
mutate(kw_min_share=mean(shares)) %>%
group_by(min_positive_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(max_negative_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(num_videos) %>%
mutate(nv_shares=mean(shares)) %>%
group_by(min_negative_polarity) %>%
mutate(minnp_shares=mean(shares)) %>%
group_by(num_self_hrefs) %>%
mutate(nsh_shares=mean(shares)) %>%
group_by(num_imgs) %>%
mutate(num_im_shares=mean(shares)) %>%
group_by(num_hrefs) %>%
mutate(num_hrefs_shares=mean(shares))
md=md %>%
mutate(sp_feat1=shares*0.3+rnorm(nrow(md),1000,1000),
sp_feat2=sqrt(shares)+rnorm(nrow(md),1000,1000))
rm(list=ls())
setwd("/Users/lalitsachan/Desktop/March onwards/CBAP with R/Data/")
library(dplyr)
library(data.table)
md=data.frame(fread("OnlineNewsPopularity.csv"))
md=md %>%
group_by(n_non_stop_words) %>%
mutate(nnsw_share=mean(shares)) %>%
group_by(num_keywords) %>%
mutate(numk_share=mean(shares)) %>%
group_by(n_tokens_title) %>%
mutate(ntt_share=mean(shares)) %>%
group_by(kw_min_min) %>%
mutate(kw_min_share=mean(shares)) %>%
group_by(min_positive_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(max_negative_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(num_videos) %>%
mutate(nv_shares=mean(shares)) %>%
group_by(min_negative_polarity) %>%
mutate(minnp_shares=mean(shares)) %>%
group_by(num_self_hrefs) %>%
mutate(nsh_shares=mean(shares)) %>%
group_by(num_imgs) %>%
mutate(num_im_shares=mean(shares)) %>%
group_by(num_hrefs) %>%
mutate(num_hrefs_shares=mean(shares))
md1=md %>%
mutate(sp_feat1=shares*0.3+rnorm(nrow(md),1000,1000),
sp_feat2=sqrt(shares)+rnorm(nrow(md),1000,1000))
class(md)
md=data.frame(md)
md1=md %>%
mutate(sp_feat1=shares*0.3+rnorm(nrow(md),1000,1000),
sp_feat2=sqrt(shares)+rnorm(nrow(md),1000,1000))
md=md %>%
mutate(sp_feat1=shares*0.3+rnorm(nrow(md),1000,1000),
sp_feat2=sqrt(shares)+rnorm(nrow(md),1000,1000))
md=md %>%
mutate(
wd_Friday=as.numeric(weekday=="Friday"),
wd_Monday=as.numeric(weekday=="Monday"),
wd_Sunday=as.numeric(weekday=="Sunday"),
wd_Thursday=as.numeric(weekday=="Thursday"),
wd_Tuesday=as.numeric(weekday=="Tuesday"),
wd_Wednesday=as.numeric(weekday=="Wednesday")
) %>%
select(-weekday)
md=md %>%
mutate(
dc_bus=as.numeric(data_channel=="business"),
dc_ent=as.numeric(data_channel=="entertainment"),
dc_life=as.numeric(data_channel=="lifestyle"),
dc_socmed=as.numeric(data_channel=="socmed"),
dc_tech=as.numeric(data_channel=="tech"),
dc_world=as.numeric(data_channel=="world")
) %>%
select(-data_channel)
fit=lm(shares~.-url,md)
summary(fit)
rm(list=ls())
setwd("/Users/lalitsachan/Desktop/March onwards/CBAP with R/Data/")
library(dplyr)
library(data.table)
md=data.frame(fread("OnlineNewsPopularity.csv"))
md=md %>%
group_by(n_non_stop_words) %>%
mutate(nnsw_share=mean(shares)) %>%
group_by(num_keywords) %>%
mutate(numk_share=mean(shares)) %>%
group_by(n_tokens_title) %>%
mutate(ntt_share=mean(shares)) %>%
group_by(kw_min_min) %>%
mutate(kw_min_share=mean(shares)) %>%
group_by(min_positive_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(max_negative_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(num_videos) %>%
mutate(nv_shares=mean(shares)) %>%
group_by(min_negative_polarity) %>%
mutate(minnp_shares=mean(shares)) %>%
group_by(num_self_hrefs) %>%
mutate(nsh_shares=mean(shares)) %>%
group_by(num_imgs) %>%
mutate(num_im_shares=mean(shares)) %>%
group_by(num_hrefs) %>%
mutate(num_hrefs_shares=mean(shares))
md=data.frame(md)
set.seed(2)
md=md %>%
mutate(sp_feat1=shares*0.3+rnorm(nrow(md),1000,2000),
sp_feat2=sqrt(shares)+rnorm(nrow(md),1000,2000))
md=md %>%
mutate(
wd_Friday=as.numeric(weekday=="Friday"),
wd_Monday=as.numeric(weekday=="Monday"),
wd_Sunday=as.numeric(weekday=="Sunday"),
wd_Thursday=as.numeric(weekday=="Thursday"),
wd_Tuesday=as.numeric(weekday=="Tuesday"),
wd_Wednesday=as.numeric(weekday=="Wednesday")
) %>%
select(-weekday)
md=md %>%
mutate(
dc_bus=as.numeric(data_channel=="business"),
dc_ent=as.numeric(data_channel=="entertainment"),
dc_life=as.numeric(data_channel=="lifestyle"),
dc_socmed=as.numeric(data_channel=="socmed"),
dc_tech=as.numeric(data_channel=="tech"),
dc_world=as.numeric(data_channel=="world")
) %>%
select(-data_channel)
fit=lm(shares~.-url,md)
summary(fit)
plot(md$shares,md$sp_feat2)
plot(md$shares,md$sp_feat1)
plot(md$shares,md$sp_feat2**2)
plot(md$shares,md$sp_feat2**2+md$sp_feat2)
plot(md$shares,-log(md$sp_feat2**2))
fit=lm(shares~.-url+sp_feat2*sp_feat2,md)
summary(fit)
md=md[-c(3269,23238,31038),]
md=md[-c(5370,9365,16268),]
md=md[-c(3146,9851,35251),]
md=md[-c(5552,18032,23579),]
fit=lm(shares~.-url+sp_feat2*sp_feat2,md)
summary(fit)
rm(list=ls())
setwd("/Users/lalitsachan/Desktop/March onwards/CBAP with R/Data/")
library(dplyr)
library(data.table)
md=data.frame(fread("OnlineNewsPopularity.csv"))
md=md %>%
group_by(n_non_stop_words) %>%
mutate(nnsw_share=mean(shares)) %>%
group_by(num_keywords) %>%
mutate(numk_share=mean(shares)) %>%
group_by(n_tokens_title) %>%
mutate(ntt_share=mean(shares)) %>%
group_by(kw_min_min) %>%
mutate(kw_min_share=mean(shares)) %>%
group_by(min_positive_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(max_negative_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(num_videos) %>%
mutate(nv_shares=mean(shares)) %>%
group_by(min_negative_polarity) %>%
mutate(minnp_shares=mean(shares)) %>%
group_by(num_self_hrefs) %>%
mutate(nsh_shares=mean(shares)) %>%
group_by(num_imgs) %>%
mutate(num_im_shares=mean(shares)) %>%
group_by(num_hrefs) %>%
mutate(num_hrefs_shares=mean(shares))
md=data.frame(md)
set.seed(2)
md=md %>%
mutate(sp_feat1=shares*0.3+rnorm(nrow(md),1000,2000),
sp_feat2=sqrt(shares)+rnorm(nrow(md),1000,2000))
md=md %>%
mutate(
wd_Friday=as.numeric(weekday=="Friday"),
wd_Monday=as.numeric(weekday=="Monday"),
wd_Sunday=as.numeric(weekday=="Sunday"),
wd_Thursday=as.numeric(weekday=="Thursday"),
wd_Tuesday=as.numeric(weekday=="Tuesday"),
wd_Wednesday=as.numeric(weekday=="Wednesday")
) %>%
select(-weekday)
md=md %>%
mutate(
dc_bus=as.numeric(data_channel=="business"),
dc_ent=as.numeric(data_channel=="entertainment"),
dc_life=as.numeric(data_channel=="lifestyle"),
dc_socmed=as.numeric(data_channel=="socmed"),
dc_tech=as.numeric(data_channel=="tech"),
dc_world=as.numeric(data_channel=="world")
) %>%
select(-data_channel)
fit=lm(shares~.-url+sp_feat2*sp_feat2,md)
vif(fit)
library(car)
vif(fit)
sort(vif(fit),decreasing = T)
rm(list=ls())
setwd("/Users/lalitsachan/Desktop/March onwards/CBAP with R/Data/")
library(dplyr)
library(data.table)
md=data.frame(fread("OnlineNewsPopularity.csv"))
md=md %>%
group_by(n_non_stop_words) %>%
mutate(nnsw_share=mean(shares)) %>%
group_by(num_keywords) %>%
mutate(numk_share=mean(shares)) %>%
group_by(n_tokens_title) %>%
mutate(ntt_share=mean(shares)) %>%
group_by(kw_min_min) %>%
mutate(kw_min_share=mean(shares)) %>%
group_by(min_positive_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(max_negative_polarity) %>%
mutate(mnp_share=mean(shares)) %>%
group_by(num_videos) %>%
mutate(nv_shares=mean(shares)) %>%
group_by(min_negative_polarity) %>%
mutate(minnp_shares=mean(shares)) %>%
group_by(num_self_hrefs) %>%
mutate(nsh_shares=mean(shares)) %>%
group_by(num_imgs) %>%
mutate(num_im_shares=mean(shares)) %>%
group_by(num_hrefs) %>%
mutate(num_hrefs_shares=mean(shares))
md=data.frame(md)
set.seed(2)
md=md %>%
mutate(sp_feat1=shares*0.3+rnorm(nrow(md),1000,2000),
sp_feat2=sqrt(shares)+rnorm(nrow(md),1000,2000))
write.csv(md,"OnlineNewsPopularity.csv",row.names = F)
names(md)
setwd("/Users/lalitsachan/Desktop/March onwards/CBAP with R/Data/")
library(data.table)
md=data.frame(fread("OnlineNewsPopularity.csv"))
View(md)
library(dplyr)
glimpse(md)
md=md %>%
mutate(
wd_Friday=as.numeric(weekday=="Friday"),
wd_Monday=as.numeric(weekday=="Monday"),
wd_Sunday=as.numeric(weekday=="Sunday"),
wd_Thursday=as.numeric(weekday=="Thursday"),
wd_Tuesday=as.numeric(weekday=="Tuesday"),
wd_Wednesday=as.numeric(weekday=="Wednesday")
) %>%
select(-weekday)
md=md %>%
mutate(
dc_bus=as.numeric(data_channel=="business"),
dc_ent=as.numeric(data_channel=="entertainment"),
dc_life=as.numeric(data_channel=="lifestyle"),
dc_socmed=as.numeric(data_channel=="socmed"),
dc_tech=as.numeric(data_channel=="tech"),
dc_world=as.numeric(data_channel=="world")
) %>%
select(-data_channel)
words=c("google","twitter","facebook","apple",
"video","new","app","iphone","social","world","2014")
for(word in words){
md[,paste0("word_",word)]=NA
for(i in 1:nrow(md)){
md[,paste0("word_",word)][i]=as.numeric(length(grep(word,md$url[i]))>0)
}
set.seed(2)
s=sample(1:nrow(md),0.8*nrow(md))
md_train=md[s,]
md_test=md[-s,]
md=md[,-1]
set.seed(2)
s=sample(1:nrow(md),0.8*nrow(md))
md_train=md[s,]
md_test=md[-s,]
fit=lm(shares~.,data=md_train)
library(car)
sort(vif(fit),decreasing = T)[10]
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens-n_non_stop_words,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens
-n_non_stop_words
-self_reference_avg_sharess,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens
-n_non_stop_words
-self_reference_avg_sharess
-rate_positive_words,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens
-n_non_stop_words
-self_reference_avg_sharess
-rate_positive_words
-kw_avg_min,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens
-n_non_stop_words
-self_reference_avg_sharess
-rate_positive_words
-kw_avg_min-kw_avg_avg,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens
-n_non_stop_words
-self_reference_avg_sharess
-rate_positive_words
-kw_avg_min-kw_avg_avg
-rate_negative_words,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens
-n_non_stop_words
-self_reference_avg_sharess
-rate_positive_words
-kw_avg_min-kw_avg_avg
-rate_negative_words
-avg_negative_polarity,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens
-n_non_stop_words
-self_reference_avg_sharess
-rate_positive_words
-kw_avg_min-kw_avg_avg
-rate_negative_words
-avg_negative_polarity
-dc_world,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
fit=lm(shares~.-LDA_03-n_unique_tokens
-n_non_stop_words
-self_reference_avg_sharess
-rate_positive_words
-kw_avg_min-kw_avg_avg
-rate_negative_words
-avg_negative_polarity
-dc_world
-global_sentiment_polarity,data=md_train)
sort(vif(fit),decreasing = T)[1:10]
md_train=md_train %>%
select(-LDA_03,-n_unique_tokens,
-n_non_stop_words,
-self_reference_avg_sharess,
-rate_positive_words,
-kw_avg_min-kw_avg_avg,
-rate_negative_words,
-avg_negative_polarity,
-dc_world,
-global_sentiment_polarity)
fit=lm(shares~.,data=md_train)
summary(fit)
fit=step(fit)
summary(fit)
fomrula(fit)
formula(fit)
summary(fit)
fit=lm(shares ~ kw_min_min + kw_avg_max + kw_max_avg + kw_avg_avg +
self_reference_min_shares + LDA_00 + global_subjectivity +
global_rate_positive_words + min_positive_polarity  +
abs_title_subjectivity + nnsw_share + ntt_share + mnp_share +
nv_shares + minnp_shares + nsh_shares + num_im_shares + num_hrefs_shares +
sp_feat1 + wd_Thursday + dc_life + word_apple + word_app +
word_iphone + word_2014,data=md_train)
summary(fit)
fit=lm(shares ~ kw_min_min + kw_avg_max + kw_max_avg + kw_avg_avg +
self_reference_min_shares + LDA_00 + global_subjectivity +
global_rate_positive_words + min_positive_polarity  +
abs_title_subjectivity + nnsw_share + ntt_share + mnp_share +
nv_shares + minnp_shares + nsh_shares + num_im_shares + num_hrefs_shares +
sp_feat1 + wd_Thursday + dc_life + word_apple +
word_iphone + word_2014,data=md_train)
summary(fit)
plot(fit,which=1)
plot(md_train$sp_feat1,fit$residuals)
plot(fit,which=2)
hist(fit$residuals)
hist(fit$residuals,breaks=1000)
hist(fit$residuals,breaks=100)
hist(fit$residuals,breaks=1000)
plot(fit,which=3)
plot(fit,which=4)
predicted=predict(fit,newdata=md_test)
RMSE=(predicted-md_test$shares)**2 %>%
mean() %>%
sqrt()
RMSE
